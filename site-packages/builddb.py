#!/usr/bin/python -tt

outfile = open("reactionsnew.txt", "w")

reactiondb = {}
dbbyeq = {}

# get current db
reactiondbFile = open("reactions.txt", "r")
for line in reactiondbFile.readlines():
  line = line.rstrip()
  line1 = line.split("\t")
  [pathwaysstr, ecsstr, id, rev, name, stringequation] = line1[0:6]
  if (id not in reactiondb.keys()) and (not id.startswith("R_EX_")):
    reactiondb[id] = (pathwaysstr, ecsstr, id, rev, name, stringequation)
  if (stringequation not in dbbyeq.keys()) and (not id.startswith("R_EX_")):
    dbbyeq[stringequation] = (pathwaysstr, ecsstr, id, rev, name, stringequation)
    if rev == False and '-->' not in stringequation:
      print id
  
equations = dbbyeq.keys()
equations.sort()

for equation in equations:
  outfile.write("%s\t%s\t%s\t%s\t%s\t%s\n" % (dbbyeq[equation][0], dbbyeq[equation][1], dbbyeq[equation][2], dbbyeq[equation][3], dbbyeq[equation][4], dbbyeq[equation][5]))
  




# sort by reaction


## get reactions from models
#modelfnames = ["models/bsu.wil", "models/tcruzi.wil", "models/hpy.wil", "models/ecoli.wil", "models/crypto.wil", "models/sys.init.photo-41.wil"]
#for modelfname in modelfnames:
#	modelfile = open(modelfname, "r")
#	lineiterator = iter(modelfile.readlines())
#	while 'Reactions' not in line:
#		line = lineiterator.next()
#	line = lineiterator.next()
#	while 'Sources' not in line:
#		if len(line) > 2:
#			line1 = line.split("\t")
#			[pathway, ec, id, reversible, name, reaction] = line1[0:6]
#			if (id not in reactiondb.keys()) and (not id.startswith("R_EX_")): 
#				reactiondb[id] = (pathway, ec, id, reversible, name, reaction)
#				print "adding ", id
#		line = lineiterator.next()
#	line = lineiterator.next()
#
## write new database
#for id in reactiondb.keys():
#	outfile.write("%s\t%s\t%s\t%s\t%s\t%s\n" % (reactiondb[id][0], reactiondb[id][1], reactiondb[id][2], reactiondb[id][3], reactiondb[id][4], reactiondb[id][5]))
